<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Http Project</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Colaboradores</h1>
        <nav id="navMenu">
            <ul>
                <li><a href="index.html">Início</a></li>
                <li><a href="treinamento.html">Consulta</a></li>
                <li><a href="colaboradores.html">Colaboradores</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <p>Lista de funcionários e treinamentos.</p>
        <div id="tableDiv" style = "overflow-x:auto;">
            <table id="colaboradoresTable">
                <thead>
                    <tr>
                        <th>nome</th>
                        <th>matrícula</th>
                        <th>cargo</th>
                        <th>nome_treinamento</th>
                        <th>exigido_para_funcao</th>
                        <th>validade_em_anos</th>
                        <th>status</th>
                    </tr>
                </thead>
                <tbody>
                    <!--rows will be populated here-->
                </tbody>
            </table>
        </div>
    </main>

    <script>
        async function fetchColaboradores() {
            const response = await fetch('http://localhost:8000/BD_ferramenta_consulta');
            const colaboradores = await response.json();

            const tableBody = document.querySelector('#colaboradoresTable tbody');
            tableBody.innerHTML = ''; //Clear existing rows

            const uniqueColaboradores = new Map(); // Use a map to filter duplicates

            colaboradores.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.nome}</td>
                    <td>${item.matricula}</td>
                    <td>${item.cargo}</td>
                    <td>${item.nome_treinamentos}</td>
                    <td>${item.exigido_para_funcao}</td>
                    <td>${item.validade_em_anos}</td>
                    <td>${item.status}</td>
                `;
                tableBody.appendChild(row);
            });
        }
        // fetch data when the page loads
        window.onload = fetchColaboradores;
    </script>

    <script src="script.js"></script>

</body> 
</html>  